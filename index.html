<html>
<head>
<title>Minor Blues Pentatonic Just Intonation Keyboard</title>
</head>
<body>

<input type="range" id="outputVolume" />
<p>
	Keys 1 to -, A to $, Q to `<br>
	Change the base frequency or keyboard type by running something like changeKeyboard(440.0, harmonicKeyboard) or changeKeyboard(D, bluesKeyboard)
</p>

<script type="text/javascript">
	const A = 440,
	B = 495,
	C = 528,
	D = 586,
	E = 660,
	F = 705,
	G = 793;
</script>

<script type="text/javascript" src="keyboard.js"></script>
<script type="text/javascript" src="scales.js"></script>
<script type="text/javascript" src="source.js"></script>

<script>

	const context = new (window.AudioContext || window.webkitAudioContext)();
	context.masterOut = context.createGain();
	context.masterOut.gain.value = .1;
	context.masterOut.connect(context.destination);

	const range = document.getElementById("outputVolume");
	range.style.width = 500;
	range.min = 0.0;
	range.max = 2.0;
	range.step = .1;
	range.value = .1;
	range.oninput = () => context.masterOut.gain.value = range.value;




	function changeKeyboard(baseFrequency, ratioKeyMap) {
		
		for(var k in sourceKeyMap)
			sourceKeyMap[k].kill();

		sourceKeyMap = {};

		for(var k in ratioKeyMap)
			sourceKeyMap[k] = createSource(ratioKeyMap[k] * baseFrequency)

	}


	function init() {
		//changeKeyboard(440.0, harmonicKeyboard);
		changeKeyboard(D/4, bluesKeyboard);
	}

	//const array = [];
	//document.addEventListener("keydown", e => array.push(e.code));
	//document.addEventListener("keydown", e => console.log(e.keyCode));

	init();

</script>

</body>
</html>